(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ed8404e"],{"1be1":function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"f",(function(){return l})),a.d(t,"g",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return s})),a.d(t,"e",(function(){return u})),a.d(t,"c",(function(){return c})),a.d(t,"h",(function(){return d}));a("b0c0");var n=a("c9b9");function r(e){return Object(n["a"])({url:"/role/list",method:"get",params:e})}function l(e){var t=e.name,a=e.memo;return Object(n["a"])({url:"/role/save",method:"post",data:{name:t,memo:a}})}function i(e){return Object(n["a"])({url:"/role/update",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/role/delete",method:"delete",params:{id:e}})}function s(){return Object(n["a"])({url:"/role/all",method:"get"})}function u(e){return Object(n["a"])({url:"/role/permissions",method:"get",params:{id:e}})}function c(){return Object(n["a"])({url:"/role/permission/tree",method:"get"})}function d(e,t){return Object(n["a"])({url:"/role/update/permissions",method:"post",data:{id:e,permissions:t}})}},"2f77":function(e,t,a){"use strict";var n=a("eb6b"),r=a.n(n);r.a},e382:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{attrs:{shadow:"hover"}},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-remove":e.removeTab},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{name:"list",closable:!1}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("svg-icon",{attrs:{"icon-class":"list"}}),e._v(" 用户列表")],1),a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"姓名",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name",t)},expression:"query.name"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"邮箱",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.query.email,callback:function(t){e.$set(e.query,"email",t)},expression:"query.email"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"用户名",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.query.username,callback:function(t){e.$set(e.query,"username",t)},expression:"query.username"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getList}},[e._v("搜索")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.data.tableLoading,expression:"data.tableLoading"}],attrs:{data:e.data.list,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),a("el-table-column",{attrs:{label:"头像",prop:"avatar",width:"100px",align:e.data.commonAlign},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{width:"40px",height:"40px","border-radius":"10px"},attrs:{src:e.row.avatar+"?d="+(new Date).getTime(),alt:"头像"}})]}}])}),a("el-table-column",{attrs:{label:"用户名",prop:"username",width:"200px",align:e.data.commonAlign}}),a("el-table-column",{attrs:{label:"姓名",prop:"name",width:"200px",align:e.data.commonAlign}}),a("el-table-column",{attrs:{label:"邮箱",prop:"email",width:"300px",align:e.data.commonAlign}}),a("el-table-column",{attrs:{label:"性别",prop:"gender",width:"100px",align:e.data.commonAlign},scopedSlots:e._u([{key:"default",fn:function(t){return["男"===t.row.gender?a("el-tag",{attrs:{type:"success"}},[e._v("男")]):a("el-tag",{attrs:{type:"warning"}},[e._v("女")])]}}])}),a("el-table-column",{attrs:{label:"创建人",width:"150px",align:e.data.commonAlign},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row["creatorName"])+" ")]}}])}),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime",width:"200px",align:e.data.commonAlign}}),a("el-table-column",{attrs:{label:"操作",align:e.data.commonAlign,"min-width":"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button-group",[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.openUpdateRoleDialog(t.row)}}},[e._v("分配角色")]),a("el-button",{attrs:{type:"danger"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])],1)]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.query.total>e.query.pageSize,expression:"query.total > query.pageSize"}],attrs:{total:e.query.total,page:e.query.page,limit:e.query.pageSize},on:{"update:page":function(t){return e.$set(e.query,"page",t)},"update:limit":function(t){return e.$set(e.query,"pageSize",t)},pagination:e.getList}})],1),a("el-tab-pane",{attrs:{name:"add",closable:!1}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("svg-icon",{attrs:{"icon-class":"add"}}),e._v(" 新增")],1),a("user-form",{attrs:{type:"ADD"},on:{"handle-update":e.saveHandle}})],1),e._l(e.tabs,(function(t){return a("el-tab-pane",{key:t.name,attrs:{name:t.name,closable:""}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("svg-icon",{attrs:{"icon-class":"edit"}}),e._v(" "+e._s(t.label))],1),a("user-form",{attrs:{obj:t.obj,type:"UPDATE"},on:{"handle-update":e.updateHandle}})],1)}))],2),a("el-dialog",{attrs:{visible:e.dialogUpdateRoleVisible,title:"编辑角色"},on:{"update:visible":function(t){e.dialogUpdateRoleVisible=t}}},[a("el-transfer",{attrs:{"filter-method":e.filterRole,data:e.roles,props:{key:"id",label:"name"},titles:["待选角色","已选角色"],filterable:"","filter-placeholder":"请输入角色名称"},model:{value:e.userRole.roleIdList,callback:function(t){e.$set(e.userRole,"roleIdList",t)},expression:"userRole.roleIdList"}}),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogUpdateRoleVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.updateRole}},[e._v("保存")])],1)],1)],1)},r=[],l=(a("4de4"),a("c975"),a("b0c0"),a("d4ec")),i=a("bee2"),o=a("2caf"),s=a("262e"),u=a("9ab4"),c=a("60a3"),d=a("bc3a"),b=a.n(d),m=a("333d"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.obj,"label-position":e.data.labelPosition,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{staticClass:"input",attrs:{placeholder:"用户名",maxlength:"64"},model:{value:e.obj.username,callback:function(t){e.$set(e.obj,"username",t)},expression:"obj.username"}})],1),a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{staticClass:"input",attrs:{placeholder:"姓名",maxlength:"20"},model:{value:e.obj.name,callback:function(t){e.$set(e.obj,"name",t)},expression:"obj.name"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{staticClass:"input",attrs:{placeholder:"邮箱",rows:6,maxlength:"128"},model:{value:e.obj.email,callback:function(t){e.$set(e.obj,"email",t)},expression:"obj.email"}})],1),a("el-form-item",{attrs:{label:"性别",prop:"gender"}},[a("el-radio-group",{model:{value:e.obj.gender,callback:function(t){e.$set(e.obj,"gender",t)},expression:"obj.gender"}},[a("el-radio-button",{attrs:{label:"男"}}),a("el-radio-button",{attrs:{label:"女"}})],1)],1),a("el-form-item",{attrs:{label:"头像",prop:"avatar"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{"show-file-list":!1,"auto-upload":!1,"on-change":e.avatarChange,action:"https://jsonplaceholder.typicode.com/posts/"}},[e.obj.avatar?a("img",{staticClass:"avatar",attrs:{src:e.obj.avatar,alt:""}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v(e._s(e.label))]),a("el-button",{on:{click:e.cancel}},[e._v("重置")])],1)],1)},f=[],h=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),function e(){Object(l["a"])(this,e),this.id="",this.name="",this.username="",this.email="",this.gender="男",this.avatar="",this.roleIdList=[]}),v=a("4849"),g=a("5154"),y=a("8819"),j=a("c9b9");function k(e){return Object(j["a"])({url:"/user/list",method:"get",params:e})}function O(e){return Object(j["a"])({url:"/user/save",method:"post",data:e})}function w(e){return Object(j["a"])({url:"/user/update",method:"post",data:e})}function x(e){return Object(j["a"])({url:"/user/delete",method:"delete",params:{id:e}})}function _(e,t){return Object(j["a"])({url:"/user/isUsernameExist",method:"get",params:{id:e,username:t}})}function L(e){return Object(j["a"])({url:"/user/roleIdList",method:"get",params:{id:e}})}function q(e){return Object(j["a"])({url:"/user/updateRole",method:"post",data:e})}var R,T=a("bc1c"),U=R=function(e){Object(s["a"])(a,e);var t=Object(o["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.data=new y["a"],e.rules={name:[{required:!0,trigger:"blur",message:"请输入姓名"}],username:[new g["a"]({message:"用户名不能为空"}),new g["a"]({},e.validateUsername)],email:[new g["a"]({message:"邮箱不能为空"}),new g["a"]({},R.validateEmail)]},e}return Object(i["a"])(a,[{key:"validateUsername",value:function(e,t,a){_(this.obj.id,t).then((function(e){e.data.isExist?a(new Error("用户名已存在")):a()}))}},{key:"avatarChange",value:function(e){this.img=e.raw,this.obj.avatar=URL.createObjectURL(e.raw)}},{key:"createFormData",value:function(){var e=new FormData;return e.append("id",this.obj.id),e.append("name",this.obj.name),e.append("username",this.obj.username),e.append("email",this.obj.email),e.append("gender",this.obj.gender),e.append("avatar",this.obj.avatar),this.img&&e.append("img",this.img),e}},{key:"submit",value:function(){var e=this;this.$refs.dataForm.validate((function(t){t&&(e.$emit("handle-update",e.createFormData()),e.type===T["a"].ADD&&e.$refs.dataForm.resetFields())}))}},{key:"cancel",value:function(){this.$refs.dataForm.resetFields()}},{key:"label",get:function(){switch(this.type){case T["a"].ADD:return"新增";case T["a"].UPDATE:return"修改"}}}],[{key:"validateEmail",value:function(e,t,a){Object(v["b"])(t)?a():a(new Error("邮箱格式不正确"))}}]),a}(c["c"]);Object(u["a"])([Object(c["b"])({default:function(){return new h}})],U.prototype,"obj",void 0),Object(u["a"])([Object(c["b"])({required:!0})],U.prototype,"type",void 0),U=R=Object(u["a"])([c["a"]],U);var D=U,$=D,A=(a("2f77"),a("2877")),E=Object(A["a"])($,p,f,!1,null,"281a68e6",null),S=E.exports,C=a("1be1"),F=a("b2b8"),I=function e(){Object(l["a"])(this,e),this.page=1,this.pageSize=20,this.total=0,this.name="",this.username="",this.email=""},V=a("bbfc"),z=function(e){Object(s["a"])(a,e);var t=Object(o["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.activeTab="list",e.query=new I,e.data=new y["a"],e.roles=[],e.userRole={id:"",roleIdList:[]},e.dialogUpdateRoleVisible=!1,e.tabs=[],e}return Object(i["a"])(a,[{key:"created",value:function(){this.getList()}},{key:"search",value:function(){this.query.page=1,this.getList()}},{key:"getList",value:function(){var e=this;this.data.tableLoading=!0,k(this.query).then((function(t){var a=t.data;e.data.list=a.rows,e.query.total=a.total,e.data.tableLoading=!1}))}},{key:"saveHandle",value:function(e){var t=this;O(e).then((function(e){t.editSuccess(e.data.message),t.activeTab="list"}))}},{key:"handleUpdate",value:function(e){var t=e.id,a=e.name,n=e.username,r=e.email,l=e.gender,i=e.avatar,o=e.roleIdList,s=this.tabs.filter((function(e){return e.name===Object(V["d"])(t)}));if(0===s.length){var u={name:Object(V["d"])(t),label:"编辑-".concat(a),obj:{id:t,name:a,username:n,email:r,gender:l,avatar:i,roleIdList:o}};this.tabs.push(u),this.activeTab=u.name}else this.activeTab=s[0].name}},{key:"updateHandle",value:function(e){var t=this;w(e).then((function(e){t.editSuccess(e.data.message),t.removeTab(t.activeTab),t.activeTab="list"}))}},{key:"removeTab",value:function(e){this.activeTab===e&&(this.activeTab="list"),this.tabs=Object(V["e"])(this.tabs,e)}},{key:"editSuccess",value:function(e){Object(F["b"])("成功",e),this.data.dialogFormVisible=!1,this.getList()}},{key:"handleDelete",value:function(e){var t=this,a=this;Object(F["a"])("删除提示","".concat(e.name,"将会被删除"),"确定","取消",(function(){x(e.id).then((function(n){Object(F["b"])("成功",n.data.message),a.tabs=Object(V["e"])(t.tabs,Object(V["d"])(e.id)),a.getList()}))}))}},{key:"filterRole",value:function(e,t){if(t.name)return t.name.indexOf(e)>-1}},{key:"openUpdateRoleDialog",value:function(e){var t=this;b.a.all([Object(C["d"])(),L(e.id)]).then(b.a.spread((function(a,n){t.roles=a.data,t.userRole={roleIdList:n.data,id:e.id},t.dialogUpdateRoleVisible=!0})))}},{key:"updateRole",value:function(){var e=this;q(this.userRole).then((function(t){Object(F["b"])("成功",t.data.message),e.dialogUpdateRoleVisible=!1,e.getList(),e.userRole={id:"",roleIdList:[]}}))}}]),a}(c["c"]);z=Object(u["a"])([Object(c["a"])({components:{Pagination:m["a"],UserForm:S}})],z);var H=z,P=H,N=Object(A["a"])(P,n,r,!1,null,"e36a1a22",null);t["default"]=N.exports},eb6b:function(e,t,a){}}]);
//# sourceMappingURL=chunk-0ed8404e.96f132c5.js.map